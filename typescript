Script started on 2024-03-24 15:48:31-06:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="120" LINES="24"]
[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ python prepare_emnist_letter.py 
[?2004lOriginal labels: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26]
Original frequencies in train: [4800 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800
 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800 4800]
Chosen labels: [12  9 15 11 23 16 18  5  1 24]
New labels: [0 1 2 3 4 5 6 7 8 9]
New frequencies in train: [4800 4800 4800 4800 4800 4800 4800 4800 4800 4800]
Original frequencies in test: [800 800 800 800 800 800 800 800 800 800 800 800 800 800 800 800 800 800
 800 800 800 800 800 800 800 800]
New frequencies in test: [800 800 800 800 800 800 800 800 800 800]
[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ cd data/emnist/
[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ ls
[?2004lmapping.txt                 t10k-images-idx3-ubyte     [0m[01;31mt10k-labels-idx1-ubyte.gz[0m  [01;31mtrain-images-idx3-ubyte.gz[0m
newtrain-images-idx3-ubyte  [01;31mt10k-images-idx3-ubyte.gz[0m  [01;31mtest-images-idx3-ubyte.gz[0m  [01;31mtrain-labels-idx1-ubyte.gz[0m
newtrain-labels-idx1-ubyte  t10k-labels-idx1-ubyte     [01;31mtest-labels-idx1-ubyte.gz[0m
[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ mv train-images-idx3-ubyte.gz train-images-idx3-ubyte.gz [1@o[1@l[1@d[1P[1P[1P[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1@o[1@r[1@i[1@g[1@i[1@natrain-images-idx3-ubyte.gz  [A]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cltrain-images-idx3-ubyte.gz [A]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C-train-images-idx3-ubyte.gz [A]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C

[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ mv train-labels-idx1-ubyte.gz train-labels-idx1-ubyte.gz [1@o[1@r[1@i[1@g[1@i[1@natrain-labels-idx1-ubyte.gz  [A]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cltrain-labels-idx1-ubyte.gz [A]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C-train-labels-idx1-ubyte.gz [A]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C

[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ ls
[?2004lmapping.txt                 [0m[01;31moriginal-train-images-idx3-ubyte.gz[0m  [01;31mt10k-images-idx3-ubyte.gz[0m  [01;31mtest-images-idx3-ubyte.gz[0m
newtrain-images-idx3-ubyte  [01;31moriginal-train-labels-idx1-ubyte.gz[0m  t10k-labels-idx1-ubyte     [01;31mtest-labels-idx1-ubyte.gz[0m
newtrain-labels-idx1-ubyte  t10k-images-idx3-ubyte               [01;31mt10k-labels-idx1-ubyte.gz[0m
[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ mv newtrain-images-idx3-ubyte newtrain-images-idx3-ubyte [1P[1P[1P
[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ mv newtrain-labels-idx1-ubyte newtrain-labels-idx1-ubyte [1P[1P[1P
[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ ls
[?2004lmapping.txt                          t10k-images-idx3-ubyte     [0m[01;31mt10k-labels-idx1-ubyte.gz[0m  train-images-idx3-ubyte
[01;31moriginal-train-images-idx3-ubyte.gz[0m  [01;31mt10k-images-idx3-ubyte.gz[0m  [01;31mtest-images-idx3-ubyte.gz[0m  train-labels-idx1-ubyte
[01;31moriginal-train-labels-idx1-ubyte.gz[0m  t10k-labels-idx1-ubyte     [01;31mtest-labels-idx1-ubyte.gz[0m
[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ CD .[K[K[K[Kcd ..
[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ ls
[?2004l[0m[01;34memnist[0m  [01;31memnist.tar[0m  [01;34mfashion[0m  [01;34mmnist[0m
[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ tar [K[K[K[Kcd ..
[?2004l[?2004h]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ python eam.py -n[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kconda actiate[K[K[Kvate eam.py[K[K[K
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ python eam.py -n
[?2004l2024-03-24 16:00:08.081015: I tensorflow/core/util/port.cc:111] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-24 16:00:08.104909: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-24 16:00:08.217528: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-24 16:00:08.217562: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-24 16:00:08.218165: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-24 16:00:08.274241: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-24 16:00:08.275117: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-24 16:00:08.889523: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-24 16:00:09.618787: I itex/core/wrapper/itex_cpu_wrapper.cc:70] Intel Extension for Tensorflow* AVX2 CPU backend is loaded.
Usage:
  eam -h | --help
  eam (-n <dataset> | -f <dataset> | -d <dataset> | -s <dataset> | -c <dataset> | -e | -r | -p | -P | -q)
    [--relsmean=MEAN] [--relsstdv=STDV] [--runpath=PATH] [ -l (en | es) ]
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ python eam.py -n emnist
[?2004l2024-03-24 16:00:15.470538: I tensorflow/core/util/port.cc:111] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-24 16:00:15.471823: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-24 16:00:15.491180: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-24 16:00:15.491208: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-24 16:00:15.491224: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-24 16:00:15.495064: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-24 16:00:15.495201: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-24 16:00:15.930304: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-24 16:00:16.286682: I itex/core/wrapper/itex_cpu_wrapper.cc:70] Intel Extension for Tensorflow* AVX2 CPU backend is loaded.
Working directory: runs
Experimental settings: {Parameters: [0.  0.  0.  0.1]}
Memory size (columns): 64
Preprocessed dataset does not exist.
Traceback (most recent call last):
  File "/home/rmorales/Sources/eam/hetero/eam.py", line 1778, in <module>
    create_and_train_network(_dataset, exp_settings)
  File "/home/rmorales/Sources/eam/hetero/eam.py", line 1700, in create_and_train_network
    history, conf_matrix = neural_net.train_network(dataset, model_prefix, es)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/Sources/eam/hetero/neural_net.py", line 176, in train_network
    training_data, training_labels = dataset.get_training(ds, fold)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/Sources/eam/hetero/dataset.py", line 30, in get_training
    return _get_segment(dataset, _TRAINING_SEGMENT, fold)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/Sources/eam/hetero/dataset.py", line 40, in _get_segment
    _get_segment.data = _load_dataset(dataset, commons.data_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/Sources/eam/hetero/dataset.py", line 76, in _load_dataset
    data_train, labels_train = _load_mnist_like(dirname, kind='train')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/Sources/eam/hetero/dataset.py", line 116, in _load_mnist_like
    with gzip.open(labels_path, 'rb') as lbpath:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/emnist/train-labels-idx1-ubyte.gz'
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ cd data/ea[Kmnist/
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ ls
[?2004lmapping.txt                          t10k-images-idx3-ubyte     [0m[01;31mt10k-labels-idx1-ubyte.gz[0m  train-images-idx3-ubyte
[01;31moriginal-train-images-idx3-ubyte.gz[0m  [01;31mt10k-images-idx3-ubyte.gz[0m  [01;31mtest-images-idx3-ubyte.gz[0m  train-labels-idx1-ubyte
[01;31moriginal-train-labels-idx1-ubyte.gz[0m  t10k-labels-idx1-ubyte     [01;31mtest-labels-idx1-ubyte.gz[0m
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ gzip train-images-idx3-ubyte 
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ gzip train-labels-idx1-ubyte [K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kbels-idx1-ubyte 
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ ls
[?2004lmapping.txt                          t10k-images-idx3-ubyte     [0m[01;31mt10k-labels-idx1-ubyte.gz[0m  [01;31mtrain-images-idx3-ubyte.gz[0m
[01;31moriginal-train-images-idx3-ubyte.gz[0m  [01;31mt10k-images-idx3-ubyte.gz[0m  [01;31mtest-images-idx3-ubyte.gz[0m  [01;31mtrain-labels-idx1-ubyte.gz[0m
[01;31moriginal-train-labels-idx1-ubyte.gz[0m  t10k-labels-idx1-ubyte     [01;31mtest-labels-idx1-ubyte.gz[0m
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ cd ..
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ cd ..[3Pls[K[Kcd ..
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ cd ..[3Plsgzip train-labels-idx1-ubyte images-idx3[C[C[C[C[C[C[Cls[Kcd data/emnist/python eam.py -n emnist
[?2004l2024-03-24 16:00:57.356270: I tensorflow/core/util/port.cc:111] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-24 16:00:57.357652: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-24 16:00:57.377209: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-24 16:00:57.377234: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-24 16:00:57.377252: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-24 16:00:57.381193: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-24 16:00:57.381351: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-24 16:00:57.833414: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-24 16:00:58.194763: I itex/core/wrapper/itex_cpu_wrapper.cc:70] Intel Extension for Tensorflow* AVX2 CPU backend is loaded.
Working directory: runs
Experimental settings: {Parameters: [0.  0.  0.  0.1]}
Memory size (columns): 64
Preprocessed dataset does not exist.
Adding 50% noise to data.
................................................................................................... 10000 ................................................................................................... 20000 ................................................................................................... 30000 ................................................................................................... 40000 ................................................................................................... 50000 ............................................................Shuffling data and labels
Saving preprocessed dataset
Delimiting segment of data.
Delimiting segment of data.
Model: "encoder"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_2 (InputLayer)        [(None, 28, 28, 1)]       0         
                                                                 
 conv2d (Conv2D)             (None, 28, 28, 4)         40        
                                                                 
 batch_normalization (Batch  (None, 28, 28, 4)         16        
 Normalization)                                                  
                                                                 
 conv2d_1 (Conv2D)           (None, 28, 28, 4)         148       
                                                                 
 batch_normalization_1 (Bat  (None, 28, 28, 4)         16        
 chNormalization)                                                
                                                                 
 max_pooling2d (MaxPooling2  (None, 14, 14, 4)         0         
 D)                                                              
                                                                 
 spatial_dropout2d (Spatial  (None, 14, 14, 4)         0         
 Dropout2D)                                                      
                                                                 
 conv2d_2 (Conv2D)           (None, 14, 14, 8)         296       
                                                                 
 batch_normalization_2 (Bat  (None, 14, 14, 8)         32        
 chNormalization)                                                
                                                                 
 conv2d_3 (Conv2D)           (None, 14, 14, 8)         584       
                                                                 
 batch_normalization_3 (Bat  (None, 14, 14, 8)         32        
 chNormalization)                                                
                                                                 
 max_pooling2d_1 (MaxPoolin  (None, 7, 7, 8)           0         
 g2D)                                                            
                                                                 
 spatial_dropout2d_1 (Spati  (None, 7, 7, 8)           0         
 alDropout2D)                                                    
                                                                 
 conv2d_4 (Conv2D)           (None, 7, 7, 16)          1168      
                                                                 
 batch_normalization_4 (Bat  (None, 7, 7, 16)          64        
 chNormalization)                                                
                                                                 
 conv2d_5 (Conv2D)           (None, 7, 7, 16)          2320      
                                                                 
 batch_normalization_5 (Bat  (None, 7, 7, 16)          64        
 chNormalization)                                                
                                                                 
 conv2d_6 (Conv2D)           (None, 7, 7, 16)          2320      
                                                                 
 batch_normalization_6 (Bat  (None, 7, 7, 16)          64        
 chNormalization)                                                
                                                                 
 max_pooling2d_2 (MaxPoolin  (None, 4, 4, 16)          0         
 g2D)                                                            
                                                                 
 spatial_dropout2d_2 (Spati  (None, 4, 4, 16)          0         
 alDropout2D)                                                    
                                                                 
 conv2d_7 (Conv2D)           (None, 4, 4, 32)          4640      
                                                                 
 batch_normalization_7 (Bat  (None, 4, 4, 32)          128       
 chNormalization)                                                
                                                                 
 conv2d_8 (Conv2D)           (None, 4, 4, 32)          9248      
                                                                 
 batch_normalization_8 (Bat  (None, 4, 4, 32)          128       
 chNormalization)                                                
                                                                 
 conv2d_9 (Conv2D)           (None, 4, 4, 32)          9248      
                                                                 
 batch_normalization_9 (Bat  (None, 4, 4, 32)          128       
 chNormalization)                                                
                                                                 
 max_pooling2d_3 (MaxPoolin  (None, 2, 2, 32)          0         
 g2D)                                                            
                                                                 
 spatial_dropout2d_3 (Spati  (None, 2, 2, 32)          0         
 alDropout2D)                                                    
                                                                 
 conv2d_10 (Conv2D)          (None, 2, 2, 64)          18496     
                                                                 
 batch_normalization_10 (Ba  (None, 2, 2, 64)          256       
 tchNormalization)                                               
                                                                 
 conv2d_11 (Conv2D)          (None, 2, 2, 64)          36928     
                                                                 
 batch_normalization_11 (Ba  (None, 2, 2, 64)          256       
 tchNormalization)                                               
                                                                 
 conv2d_12 (Conv2D)          (None, 2, 2, 64)          36928     
                                                                 
 batch_normalization_12 (Ba  (None, 2, 2, 64)          256       
 tchNormalization)                                               
                                                                 
 max_pooling2d_4 (MaxPoolin  (None, 1, 1, 64)          0         
 g2D)                                                            
                                                                 
 spatial_dropout2d_4 (Spati  (None, 1, 1, 64)          0         
 alDropout2D)                                                    
                                                                 
 flatten (Flatten)           (None, 64)                0         
                                                                 
 encoded (LayerNormalizatio  (None, 64)                128       
 n)                                                              
                                                                 
=================================================================
Total params: 123932 (484.11 KB)
Trainable params: 123212 (481.30 KB)
Non-trainable params: 720 (2.81 KB)
_________________________________________________________________
Model: "classifier"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_3 (InputLayer)        [(None, 64)]              0         
                                                                 
 dense (Dense)               (None, 64)                4160      
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 64)                4160      
                                                                 
 dropout_1 (Dropout)         (None, 64)                0         
                                                                 
 classified (Dense)          (None, 10)                650       
                                                                 
=================================================================
Total params: 8970 (35.04 KB)
Trainable params: 8970 (35.04 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Model: "decoder"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_4 (InputLayer)        [(None, 64)]              0         
                                                                 
 dense_2 (Dense)             (None, 1568)              101920    
                                                                 
 reshape (Reshape)           (None, 7, 7, 32)          0         
                                                                 
 conv2d_13 (Conv2D)          (None, 7, 7, 64)          18496     
                                                                 
 up_sampling2d (UpSampling2  (None, 14, 14, 64)        0         
 D)                                                              
                                                                 
 spatial_dropout2d_5 (Spati  (None, 14, 14, 64)        0         
 alDropout2D)                                                    
                                                                 
 batch_normalization_13 (Ba  (None, 14, 14, 64)        256       
 tchNormalization)                                               
                                                                 
 conv2d_14 (Conv2D)          (None, 14, 14, 32)        18464     
                                                                 
 up_sampling2d_1 (UpSamplin  (None, 28, 28, 32)        0         
 g2D)                                                            
                                                                 
 spatial_dropout2d_6 (Spati  (None, 28, 28, 32)        0         
 alDropout2D)                                                    
                                                                 
 batch_normalization_14 (Ba  (None, 28, 28, 32)        128       
 tchNormalization)                                               
                                                                 
 conv2d_15 (Conv2D)          (None, 28, 28, 1)         289       
                                                                 
 decoded (Rescaling)         (None, 28, 28, 1)         0         
                                                                 
=================================================================
Total params: 139553 (545.13 KB)
Trainable params: 139361 (544.38 KB)
Non-trainable params: 192 (768.00 Byte)
_________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_1 (InputLayer)        [(None, 28, 28, 1)]          0         []                            
                                                                                                  
 encoder (Functional)        (None, 64)                   123932    ['input_1[0][0]']             
                                                                                                  
 classifier (Functional)     (None, 10)                   8970      ['encoder[0][0]']             
                                                                                                  
 decoder (Functional)        (None, 28, 28, 1)            139553    ['encoder[0][0]']             
                                                                                                  
==================================================================================================
Total params: 272455 (1.04 MB)
Trainable params: 271543 (1.04 MB)
Non-trainable params: 912 (3.56 KB)
__________________________________________________________________________________________________
2024-03-24 16:01:53.819027: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:117] Plugin optimizer for device_type CPU is enabled.
Epoch 1/300
^CTraceback (most recent call last):
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/framework/ops.py", line 1547, in get_attr
    pywrap_tf_session.TF_OperationGetAttrValueProto(self._c_op, name, buf)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Operation 'Adam/truediv_96' has no attr named '_read_only_resource_inputs'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/rmorales/Sources/eam/hetero/eam.py", line 1778, in <module>
    create_and_train_network(_dataset, exp_settings)
  File "/home/rmorales/Sources/eam/hetero/eam.py", line 1700, in create_and_train_network
    history, conf_matrix = neural_net.train_network(dataset, model_prefix, es)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/Sources/eam/hetero/neural_net.py", line 219, in train_network
    history = model.fit(training_data,
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 65, in error_handler
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/keras/src/engine/training.py", line 1783, in fit
    tmp_logs = self.train_function(iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/eager/polymorphic_function/polymorphic_function.py", line 831, in __call__
    result = self._call(*args, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/eager/polymorphic_function/polymorphic_function.py", line 887, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/eager/polymorphic_function/polymorphic_function.py", line 694, in _initialize
    self._concrete_variable_creation_fn = tracing_compilation.trace_function(
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compilation.py", line 178, in trace_function
    concrete_function = _maybe_define_function(
                        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compilation.py", line 284, in _maybe_define_function
    concrete_function = _create_concrete_function(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compilation.py", line 308, in _create_concrete_function
    traced_func_graph = func_graph_module.func_graph_from_py_func(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/framework/func_graph.py", line 987, in func_graph_from_py_func
    with func_graph.as_default(), deps_control_manager as deps_ctx:
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/framework/auto_control_deps.py", line 459, in __exit__
    for inp, resource_type in _get_resource_inputs(op):
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/framework/auto_control_deps.py", line 608, in _get_resource_inputs
    reads, writes = utils.get_read_write_resource_inputs(op)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/framework/auto_control_deps_utils.py", line 105, in get_read_write_resource_inputs
    read_only_input_indices = op.get_attr(READ_ONLY_RESOURCE_INPUTS_ATTR)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/site-packages/tensorflow/python/framework/ops.py", line 1546, in get_attr
    with c_api_util.tf_buffer() as buf:   # pytype: disable=wrong-arg-count
  File "/home/rmorales/opt/anaconda3/envs/eam/lib/python3.11/contextlib.py", line 141, in __exit__
    def __exit__(self, typ, value, traceback):

KeyboardInterrupt

[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ ls
[?2004lassociative.py  eam.pot                   [0m[01;34mlocale[0m                    qudeq.py    [01;34mruns_4d-fashion[0m  weights.py
commons.py      eam.py                    neural_net.py             README.md   stats.py
custom_set.py   hetero_associative_4d.py  plot_presence.py          [01;32mrunexps.sh[0m  test-am.py
[01;34mdata[0m            [01;32miotas.sh[0m                  prepare_emnist_letter.py  [01;34mruns[0m        test-hetero.py
dataset.py      LICENSE                   [01;34m__pycache__[0m               [01;34mruns_3d[0m     typescript
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ cd em[K[Kdata/emnist/
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ ls
[?2004lmapping.txt                          prep_labels.npy            t10k-labels-idx1-ubyte     [0m[01;31mtrain-images-idx3-ubyte.gz[0m
[01;31moriginal-train-images-idx3-ubyte.gz[0m  prep_noised_data.npy       [01;31mt10k-labels-idx1-ubyte.gz[0m  [01;31mtrain-labels-idx1-ubyte.gz[0m
[01;31moriginal-train-labels-idx1-ubyte.gz[0m  t10k-images-idx3-ubyte     [01;31mtest-images-idx3-ubyte.gz[0m
prep_data.npy                        [01;31mt10k-images-idx3-ubyte.gz[0m  [01;31mtest-labels-idx1-ubyte.gz[0m
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ cd ..
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ ls
[?2004l[0m[01;34memnist[0m  [01;31memnist.tar[0m  [01;34mfashion[0m  [01;34mmnist[0m
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ rm emnist
[?2004lrm: cannot remove 'emnist': Is a directory
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ rm emnist.tar 
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ tar czf eman[K[Knist.tar [K.gz [K[K[K[K[K[Kgz emnist/[K
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ ls -l
[?2004ltotal 133640
drwxrwxr-x 2 rmorales rmorales      4096 mar 24 16:01 [0m[01;34memnist[0m
-rw-rw-r-- 1 rmorales rmorales 136833430 mar 24 16:03 [01;31memnist.tgz[0m
drwxrwxr-x 2 rmorales rmorales      4096 feb 17  2023 [01;34mfashion[0m
drwxrwxr-x 2 rmorales rmorales      4096 feb 17  2023 [01;34mmnist[0m
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ cd mnist
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/mnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/mnist[00m$ ls
[?2004lprep_data.npy           prep_labels.npy-prop.npy       [0m[01;31mt10k-images-idx3-ubyte.gz[0m   [01;31mtrain-labels-idx1-ubyte.gz[0m
prep_data.npy-prop.npy  prep_noised_data.npy           [01;31mt10k-labels-idx1-ubyte.gz[0m
prep_labels.npy         prep_noised_data.npy-prop.npy  [01;31mtrain-images-idx3-ubyte.gz[0m
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/mnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/mnist[00m$ pythonb[K
[?2004lPython 3.11.8 | packaged by conda-forge | (main, Feb 16 2024, 20:53:32) [GCC 12.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import numpy as np
>>> labels = np.load('pre_p[Klabels[K[K[K[K[K[K[Kp_labels.npy_prop[K[K[K[K[K-prop.npy')[K[K[K[K[K[K[K[K[K[K[K[K[K[Knpy')
>>> digits, counts = np.unique(labels, return-counts[K[K[K[K[K[K[K_counts=True)
>>> digits
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
>>> counts
array([6903, 7877, 6990, 7141, 6824, 6313, 6876, 7293, 6825, 6958])
>>> 
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/mnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/mnist[00m$ cd ../emnist/
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ python
[?2004lPython 3.11.8 | packaged by conda-forge | (main, Feb 16 2024, 20:53:32) [GCC 12.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> counts[C[C[C[Cdigits, counts = np.unique(labels, return_counts=True)[C[C[C[C[19Plabels = np.load('prep_labels.npy')[C[C[C[C[17Pimport numpy as np[C[C[C[Ca[Kimport numpy as np
>>> import numpy as np[C[C[C[C[12Pcounts[C[C[C[Cdigits, counts = np.unique(labels, return_counts=True)[C[C[C[C[19Plabels = np.load('prep_labels.npy')
>>> labels = np.load('prep_labels.npy')[C[C[C[C[17Pimport numpy as np[C[C[C[C[12Pcounts[C[C[C[Cdigits, counts = np.unique(labels, return_counts=True)
>>> digits
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
>>> counts
array([5600, 5600, 5600, 5600, 5600, 5600, 5600, 5600, 5600, 5600])
>>> 
[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data/emnist[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data/emnist[00m$ more no[K[K[K[K[K[K[Kcd ..
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/data[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/data[00m$ cd ..
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero[00m$ more noh[K[K[K[K[K[K[K[Kcd runs
[?2004l[?2004h(eam) ]0;rmorales@rafathinkpad: ~/Sources/eam/hetero/runs[01;32mrmorales@rafathinkpad[00m:[01;34m~/Sources/eam/hetero/runs[00m$ c[Kmore exps.log 
[?2004lEAM Hetero experiments.
Storing results in runs_4d
=================== Starting...
lun mar 11 14:53:09 CST 2024
2024-03-11 14:53:10.384929: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to 
use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appro
priate compiler flags.
2024-03-11 14:53:11.949276: E tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CU
DA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2024-03-11 14:53:11.949317: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:168] retrieving CUDA diag
nostic information for host: luis-Alienware-Aurora-R5
2024-03-11 14:53:11.949324: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:175] hostname: luis-Alien
ware-Aurora-R5
2024-03-11 14:53:11.949392: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:199] libcuda reported ver
sion is: 465.19.1
2024-03-11 14:53:11.949414: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:203] kernel reported vers
ion is: 465.19.1
2024-03-11 14:53:11.949421: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:309] kernel version seems
 to match DSO: 465.19.1
Working directory: runs_4d
Experimental settings: {Parameters: [0.  0.  0.  0.1]}
Memory {n: 64, m: 16, xi: 0.0, iota: 0.0, kappa: 0.0, sigma: 0.1}, has been created
[7m--More--(1%)[27mMemory {n: 64, m: 16, xi: 0.0, iota: 0.0, kappa: 0.0, sigma: 0.1}, has been created
[7m--More--(1%)[27m[K
[7m--More--(2%)[27m[K
[7m--More--(2%)[27mValidating coherence between data and network for filling data of mnist
[7m--More--(2%)[27mAgreement percentage: 95.12822344453176
[7m--More--(2%)[27m[K
[7m--More--(3%)[27mValidating coherence between data and network for testing data of mnist
[7m--More--(3%)[27mAgreement percentage: 95.57395773843518
[7m--More--(3%)[27m